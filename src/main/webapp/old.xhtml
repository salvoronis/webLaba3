<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ace="http://www.icefaces.org/icefaces/components"
  xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>Main Page</title>
  <h:outputStylesheet library="css" name="style.css"/>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
</h:head>
<h:body>
  <h:form id="newData">
    <div id="zaebalo" class="graph">
      <h:commandLink value="">
        <div>
          <h:form id="workpls">
          <svg id="fuck" version="1.2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="graph" aria-labelledby="title" role="img">
            <title id="title">jsf очень больно</title>
            <g class="grid x-grid" id="xGrid">
              <line id="yline" x1="270" x2="270" y1="20" y2="520"></line>
              <polygon id="ytrig" points="270,0 265,20 275,20" stroke="#acb299" fill="#acb299"></polygon>
            </g>
            <g class="grid y-grid" id="yGrid">
              <line fill="black" id="xline" x1="20" x2="520" y1="270" y2="270"></line>
              <polygon id="xtrig" points="520,265 520,275 540,270" stroke="#acb299" fill="#acb299"></polygon>
            </g>
            <g class="labels x-labels">
              <text class="xpoint" x="120" y="270">-#{labaBean.radius}</text>
              <text class="xpoint" x="195" y="270">-#{labaBean.radius}/2</text>
              <text class="xpoint" x="270" y="270">0</text>
              <text class="xpoint" x="345" y="270">#{labaBean.radius}/2</text>
              <text class="xpoint" x="420" y="270">#{labaBean.radius}</text>
              <text id="xp" x="430" y="265" class="label-title">x</text>
            </g>
            <g class="labels y-labels">
              <text class="ypoint" x="270" y="120">#{labaBean.radius}</text>
              <text class="ypoint" x="270" y="195">#{labaBean.radius}/2</text>
              <text class="ypoint" x="270" y="270"></text>
              <text class="ypoint" x="270" y="345">-#{labaBean.radius}/2</text>
              <text class="ypoint" x="270" y="420">-#{labaBean.radius}</text>
              <text id="yp" x="270" y="10" class="label-title">y</text>
            </g>
            <g class="data" data-setname="Our first data set">
              <rect class="meichu" x="270" y="270" width="#{labaBean.radius*50}" height="#{labaBean.radius*25}"/>
              <polygon id="triangle" class="meichu" points="270,270 #{labaBean.radius*50+270},270 270,#{270-labaBean.radius*25}"></polygon>
              <path class="meichu" d="M #{270-labaBean.radius*25} 270 A 90 90, 0, 0, 0, 270 #{270+labaBean.radius*25} L 270 270 Z"></path>
            </g>
          </svg>
        </h:form>
        </div>
        <f:ajax action="click" listener="#{labaBean.suka}" execute="newData" render="pointTable x y r"/>
      </h:commandLink>
    </div>
		<h:outputLabel for="sliderx" value="x"/>
		<ace:sliderEntry id="sliderx" 
			axis="x" 
			clickableRail="true"
			length="150"
			min="-2"
			max="2"
			stepPercent="25"
			showLabels="true"
			value="#{labaBean.menuItem.slider}">
		</ace:sliderEntry>
    <br/>
		<h:outputLabel for="ytext" value="y"/>
		<h:inputText id="ytext" value="#{labaBean.menuItem.input}">
			<f:validator validatorId="textValidator"/>
      <f:validateLength minimum="1" maximum="2"/>
		</h:inputText>
		<h:outputLabel for="selectr" value="r"/>
    <h:form id="iabolshenemogu">
  		<ace:simpleSelectOneMenu id="selectr" value="#{labaBean.radius}" valueChangeListener="#{labaBean.change}"> 
  			<f:selectItem itemValue="1" itemLabel="1"/> 
  			<f:selectItem itemValue="1.5" itemLabel="1.5"/>
  			<f:selectItem itemValue="2" itemLabel="2"/> 
  			<f:selectItem itemValue="2.5" itemLabel="2.5"/> 
  			<f:selectItem itemValue="3" itemLabel="3"/>
        <ace:ajax />
  		</ace:simpleSelectOneMenu>
    </h:form>
    <p:outputPanel>
      <h:inputHidden id="r" value="#{labaBean.radius}"/>
      <h:inputHidden id="x" value="#{labaBean.imageItem.slider}"/>
      <h:inputHidden id="y" value="#{labaBean.imageItem.input}"/>
    </p:outputPanel>
		<h:commandButton value="Check" action="#{labaBean.addItem()}">
			<f:ajax execute="newData" render="pointTable"/>
		</h:commandButton>
		<h:panelGroup id="pointTable">
			<h:dataTable value="#{labaBean.items}" var="point">
        <h:column>
					<f:facet name="header">X</f:facet>
					#{point.x}
				</h:column>
				<h:column>
					<f:facet name="header">Y</f:facet>
					#{point.y}
				</h:column>
				<h:column>
					<f:facet name="header">R</f:facet>
					#{point.r}
				</h:column>
        <h:column>
          <f:facet name="header">Результат</f:facet>
          #{point.result}
        </h:column>
			</h:dataTable>
		</h:panelGroup>
	</h:form>
</h:body>
<script type="text/javascript">
  $("svg").on("click",function(event){
    console.log("pizdec blyzd");
    $("input[id$=':x']").val(event.pageX);
    $("input[id$=':y']").val(event.pageY);
  });
</script>
</html>